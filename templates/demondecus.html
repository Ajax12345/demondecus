<html>
  <style>
    .clef{
      background-image: url('/static/treble_cleff.png');
      background-repeat:no-repeat;
      background-size: cover;
      width:80px;
      height:80px;
      margin-right:-65px;
      margin-top:-20px;
    }
    .music_line{
      width:900px;
      height:165px;

    }
    .music_bar{
      width:900px;
      height:15px;
      border-bottom:solid;
      border-bottom-width:1px;
      border-right:solid;
      border-left:solid;
      border-right-width:1px;
      border-left-width:1px;
    }
    .header{
      height:70px;
      width:auto;
      background-color: #4D77EA;
    }
    .select_datasets{
      color:white;
      font-size:20px;
      line-height:70px;
      float:right;
      margin-right:60px;
      font-family: 'Roboto', sans-serif;

    }
    .select_datasets:hover{
      cursor:pointer;
      text-decoration: underline;

    }
    .composer_pannel{
      width:250px;
      padding-top:10px;
      padding-bottom:10px;
      border:solid;
      border-top:none;
      border-bottom-right-radius: 10px;
      border-bottom-left-radius: 10px;
      position:absolute;
      border-width:1px;
      margin-left:1130px;
      text-align: center;
      background-color: white;
      z-index:1;

    }
    .pannel_composer{
      padding:5px;
      font-family: 'Roboto', sans-serif;
      font-size:24px;
      z-index:1;

    }
    .pannel_composer:hover{
      cursor:pointer;
    }
    .selected{
      background-color: #CFCFCF;
    }
    .note_block{
      height:15px;
      width:20px;
      background-color: #F46A8A;
      border-bottom:solid;
      border-bottom-width:1px;
      position:relative;
      z-index:1;

    }

    .no_border{
      border-bottom:none;
      border-left-color:white;
      border-right-color:white;
    }
    .no_border1{
      border-bottom:none;
      border-left-color:white;
      border-right-color:white;
    }
    .no_border2{
      border-bottom:solid;
      border-bottom-width:1px;
    }
    .quarter_note{
      background-image: url('/static/quarter-note.png');
      background-repeat:no-repeat;
      background-size: contain;
      width:30px;
      height:30px;
      z-index:2;
      position:absolute;
      margin-top:-17px;
      margin-left:-5px;

    }

  </style>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans|Heebo" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class='header'>
      <p class='select_datasets'>Datasets</p>
    </div>
    <div class='composer_pannel' style='display:none'>
      <div class='pannel_composer selected' data-composer='1'>
        Tchaikovsky
      </div>
      <div class='pannel_composer' data-composer='2'>
        Mozart
      </div>
      <div class='pannel_composer' data-composer='3'>
        Puccini
      </div>
    </div>
    <div style='height:100px'></div>
    <div class='composition'>
    </div>


  </body>
  <script>
    $(document).ready(function(){
      var note_block_count = 1;
      for (var i = 1; i < 8; i++){
        var html = `
        <table style='margin:0 auto;' data-line='${i}' id='music_table${i}'>
        <tr>
          <td><div class='clef'></div></td>
          <td>
          <div class='music_line' data-line='${i}' id='music_line${i}'>
            <div class='music_bar no_border1' data-bar='1' data-parent='${i}' id='music_bar_${i}_1'></div>
            <div class='music_bar no_border1' data-bar='2' data-parent='${i}' id='music_bar_${i}_2'></div>
            <div class='music_bar no_border1 no_border2' data-bar='3' data-parent='${i}' id='music_bar_${i}_3'></div>
            <div class='music_bar' data-bar='4' data-parent='${i}' id='music_bar_${i}_4'></div>
            <div class='music_bar' data-bar='5' data-parent='${i}' id='music_bar_${i}_5'></div>
            <div class='music_bar' data-bar='6' data-parent='${i}' id='music_bar_${i}_6'></div>
            <div class='music_bar' data-bar='7' data-parent='${i}' id='music_bar_${i}_7'></div>
            <div class='music_bar no_border' data-bar='8' data-parent='${i}' id='music_bar_${i}_8'></div>
            <div class='music_bar no_border' data-bar='9' data-parent='${i}' id='music_bar_${i}_9'></div>
            <div class='music_bar no_border' data-bar='10' data-parent='${i}' id='music_bar_${i}_10'></div>
          </div>
          </td>
        </tr>
        </table>
        <div style='height:50px;'></div>
        `;
        $('.composition').append(html);

      }
      for (var i = 1; i < 11; i++){
        var html = `
        <div class='note_block' style='margin-left:60px;' data-blockcount="${note_block_count}" data-position="${i}"></div>
        `;
        $("#music_bar_1_"+i.toString()).append(html);
      }
      note_block_count++;
      $('.header').on('click', '.select_datasets', function(){
        if ($('.composer_pannel').css('display') === 'none'){
          $('.composer_pannel').css('display', 'block');
        }
        else{
          $('.composer_pannel').css('display', 'none');
        }
      });
      $('.composer_pannel').on('click', '.pannel_composer', function(){
        var _id = parseInt($(this).data('composer'));
        var ref = $(this);
        $('.pannel_composer').each(function(){
          $(this).attr('class', 'pannel_composer');
        });
        ref.attr('class', 'pannel_composer selected');
      });
      $('.composition').on('click', '.note_block', function(){
        var ref = $(this);
        var flag = true;
        var count = parseInt(ref.data('blockcount'));

        $('.note_block').each(function(){
          if (parseInt($(this).data('blockcount')) === count){
            $(this).css('background-color', 'white');
            var pos = parseInt($(this).data('position'));
            if (3 > pos || pos > 7 ){
              $(this).css('border-bottom-color', 'white');
            }

            $(this).html('');
          }
        });
        if (count+1 === note_block_count){
          for (var i = 1; i < 11; i++){
            var html = `
            <div class='note_block' data-blockcount="${note_block_count}" data-position="${i}"></div>
            `;
            $("#music_bar_1_"+i.toString()).append(html);
          }
          note_block_count++;
        }
        ref.append("<div class='quarter_note'></div>");
      });
      $(document).on({

          mouseenter: function () {
            if ($(this).css('background-color') != 'rgb(255, 255, 255)'){
              $(this).css( 'cursor', 'pointer' );
              $(this).css('background-color', '#FC9FB4');
            }


          },
          mouseleave: function () {
            if ($(this).css('background-color') != 'rgb(255, 255, 255)'){
              $(this).css( 'cursor', 'default' );
              $(this).css('background-color', '#F46A8A');
            }

          }
      }, ".note_block");
    });
  </script>
</html>
